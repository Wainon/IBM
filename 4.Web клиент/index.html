<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Тесты</title>
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
        background-color: #1e1e1e;
      }

      a {
        text-decoration: none;
      }

      .container {
        width: 97%;
        padding: 0 10px;
        margin: 0 auto;
        background-color: #2e2e2e;
        justify-content: center;
        align-items: center;
        margin-top: 10px;
        border-radius: 30px;
      }

      .navbar {
        display: flex;
        text-align: left;
        justify-content: space-between;
        align-items: center; /* Center items vertically */
        border-radius: 40px;
        position: relative;
        font-family: Arial, Helvetica, sans-serif; /* Font for navbar */
      }

      .navbar ul {
        list-style: none;
        display: flex;
        gap: 20px;
      }

      .navbar ul li {
        color: white;
        position: relative; /* Position for dropdown */
      }

      .navbar a {
        color: white;
        margin-right: 20px;
      }

      .dropdown {
        display: none; /* Hidden by default */
        position: absolute; /* Position relative to parent */
        background-color: #3a3a3a; /* Background color */
        border: 1px solid #ccc; /* Border color */
        border-radius: 5px; /* Rounded corners */
        z-index: 1000; /* Layering */
        padding: 10px; /* Inner padding */
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2); /* Shadow */
        color: white;
      }

      .navbar ul li:hover .dropdown {
        display: block; /* Show dropdown on hover */
      }

      .dropdown ul {
        list-style: none; /* Remove list markers */
        padding: 0; /* Remove padding */
        margin: 0; /* Remove margin */
      }

      .dropdown ul li {
        padding: 5px 0; /* Padding for dropdown items */
      }

      .dropdown ul li a {
        text-decoration: none; /* Remove underline */
        color: white; /* Text color */
        display: block; /* Make the link fill the list item */
        transition: all 0.3s ease; /* Smooth transition */
      }

      .dropdown ul li a:hover {
        color: white; /* Change text color on hover */
        background-color: rgb(101, 101, 101); /* Background color on hover */
        box-shadow: 0 0 10px rgb(52, 52, 52); /* Blue glow effect */
      }

      main {
        display: flex;
        justify-content: space-between;
        width: 100%;
        height: 90vh;
      }

      main section {
        width: 50%;
        margin: 10px;
        border-radius: 25px;
        box-shadow: 4px 4px 5px rgb(27, 27, 27);
        display: flex;
        flex-direction: column;
      }

      .all-tests {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        background-color: #3a3a3a;
        padding: 20px;
        flex: 1;
        overflow-y: auto;
        position: relative;
      }

      .current-test {
        background-color: #3c4043;
        background-position: center;
        background-size: cover;
        background-repeat: no-repeat;
        flex: 1;
        margin-left: 0px;
        width: 400px;
        color: rgb(230, 223, 215);
        font-family: Arial, Helvetica, sans-serif;
      }

      .current-test p {
        margin-left: 18px;
        font-family: Arial, Helvetica, sans-serif;
      }

      .current-test h1 {
        margin-left: 18px;
        font-family: Arial, Helvetica, sans-serif;
      }

      .current-test h2 {
        color: rgb(230, 223, 215);
        font-family: Arial, Helvetica, sans-serif;
        text-align: center;
        font-size: 30px;
      }

      .all-tests div {
        background-color: rgb(161, 233, 255);
        border-radius: 15px;
        font-family: Arial, Helvetica, sans-serif;
        color: rgb(0, 0, 0);
        padding-left: 10px;
        width: 650px;
        margin-bottom: 0px;
        box-shadow: 2px 2px 5px rgb(113, 113, 113);
        margin-left: -30px;
        margin-right: 100px;
      }

      .all-tests div p {
        color: rgb(62, 62, 62);
      }

      .all-tests {
        position: relative;
        padding: 20px;
      }

      .create-new {
        position: fixed;
        bottom: 18px;
        left: 670px;
        width: 50px;
        height: 50px;
        color: rgb(0, 0, 0);
        background-color: #00ff55;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 90px;
        font-size: 30px;
        box-shadow: 2px 2px 5px black;
        border: 1px solid rgb(0, 129, 22);
        user-select: none;
      }

      .title {
        font-family: Arial, Helvetica, sans-serif;
        margin-left: 5px;
        margin-top: -4px;
        margin-bottom: 10px;
        font-size: 24px;
        color: white;
      }

      survey-item {
        position: relative;
        padding: 20px;
        border: 1px solid #ccc;
        margin-bottom: 20px;
      }

      .ul-ct {
        list-style: none;
      }

      .li-at {
        list-style: none;
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="container">
        <nav class="navbar">
          <ul>
            <li>
              Предметы:
              <div class="dropdown">
                <ul>
                  <li><a href="#">Математика</a></li>
                  <li><a href="#">Дел. Коммуникация</a></li>
                  <li><a href="#">Физика</a></li>
                  <li><a href="#">Химия</a></li>
                </ul>
              </div>
            </li>
          </ul>
          <a href="start.html">Выход</a>
        </nav>
      </div>
    </header>
    <main>
      <section class="all-tests">
        <p class="title">
          Количество тестов: <span class="questsCounter"></span>
        </p>

        <div class="show-not"></div>

        <ul class="tests"></ul>

        <p class="create-new"><a href="creating.html">+</a></p>
      </section>
      <section class="current-test">
        <div
          class="right-panel"
          style="width: 100%; height: 100%; border-radius: 25px"
        >
          <h2>Выберите тест для просмотра</h2>
        </div>
      </section>
    </main>
    <script>
      const createNew = document.querySelector(".create-new");
      const questsCounter = document.querySelector(".questsCounter");

      function loadTests() {
        const getTests = JSON.parse(localStorage.getItem("tests")) || [];
        const testsList = document.querySelector(".tests");
        testsList.innerHTML = ""; // Очистка списка тестов

        if (getTests.length > 0) {
          getTests.forEach((item, index) => {
            testsList.innerHTML += `
                <li class="li-at">
                    <a href="#" class="test-item" data-index="${index}">
                        <div class="current-test">
                            <h1>${item.title}</h1>
                            <p>${item.description}</p>
                        </div>
                    </a>
                </li>`;
          });
        } else {
          const showNotElement = document.querySelector(".show-not");
          showNotElement.innerHTML = `<h3>Тесты отсутствуют</h3>`;
        }

        questsCounter.textContent = getTests.length;

        // Добавляем обработчик клика для каждого теста
        document.querySelectorAll(".test-item").forEach((item) => {
          item.addEventListener("click", (event) => {
            event.preventDefault(); // Предотвращаем переход по ссылке
            const index = item.getAttribute("data-index");
            displayTest(index);
          });
        });
      }

      function displayTest(index) {
        const getTests = JSON.parse(localStorage.getItem("tests")) || [];
        const rightPanel = document.querySelector(".right-panel");

        if (getTests[index]) {
          const test = getTests[index];
          rightPanel.innerHTML = `
    <h2>${test.title}</h2>
    <ul class="ul-ct">
        ${test.questions
          .map(
            (q, i) => `
            <li>
                <h3 style="font-size: 22px; margin-bottom: 5px;">${i + 1}. ${
              q.question
            }</h3>
                <div class="answers">
                    ${q.answers
                      .map(
                        (answer, j) => `
                        <label>
                            <input type="radio" name="answer${i}" value="${
                          j + 1
                        }" /> ${answer}
                        </label><br>
                    `
                      )
                      .join("")}
                </div>
            </li>
        `
          )
          .join("")}
    </ul>
`;

          // Восстанавливаем выбранные ответы, если они есть
          test.questions.forEach((q, i) => {
            const selectedAnswer = localStorage.getItem(
              `selectedAnswer_${index}_${i}`
            );
            if (selectedAnswer) {
              const answerInput = document.querySelector(
                `input[name="answer${i}"][value="${selectedAnswer}"]`
              );
              if (answerInput) {
                answerInput.checked = true; // Устанавливаем выбранный ответ
              }
            }

            // Добавляем обработчики событий для радиокнопок
            const answers = document.querySelectorAll(
              `input[name="answer${i}"]`
            );
            answers.forEach((answer) => {
              answer.addEventListener("change", (event) => {
                const selectedAnswer = event.target.value;
                // Сохраняем выбранный ответ в localStorage
                localStorage.setItem(
                  `selectedAnswer_${index}_${i}`,
                  selectedAnswer
                );
              });
            });
          });
        }
      }

      // Загрузка тестов при загрузке страницы
      loadTests();

      if (createNew) {
        createNew.addEventListener("click", () => {
          // Логика для создания нового теста
        });
      }
    </script>
  </body>
</html>
